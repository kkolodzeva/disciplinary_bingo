<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–µ –±–∏–Ω–≥–æ</title>
<style>
body { font-family: Arial; background:#f2f2f2; text-align:center; padding:30px; }
h1 { margin-bottom:40px; }
.boards { display:flex; justify-content:center; gap:80px; flex-wrap:wrap; }
.board { display:flex; flex-direction:column; align-items:center; }
.grid { display:grid; grid-template-columns:repeat(3,120px); grid-template-rows:repeat(3,120px); gap:10px; margin-top:15px; }
.cell { display:flex; justify-content:center; align-items:center; color:white; font-size:14px; cursor:pointer; border-radius:10px; transition:.3s; user-select:none; padding:8px; text-align:center; }
.lisa .cell { background-color:#8B0000; }
.katya .cell { background-color:#006B3C; }
.cell.active { opacity:.4; transform:scale(.95); }
.bingo { margin-top:10px; font-weight:bold; font-size:18px; color:green; display:none; }
button { margin-top:15px; padding:8px 15px; border:none; border-radius:6px; cursor:pointer; }
</style>
</head>
<body>

<h1>–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–µ –±–∏–Ω–≥–æ</h1>

<div class="boards">
<div class="board lisa">
<h2>–õ–∏–∑–∞</h2>
<div class="grid" id="lisaGrid"></div>
<div class="bingo" id="lisaBingo">–ë–ò–ù–ì–û üéâ</div>
<button id="lisaReset">–°–±—Ä–æ—Å</button>
</div>

<div class="board katya">
<h2>–ö–∞—Ç—è</h2>
<div class="grid" id="katyaGrid"></div>
<div class="bingo" id="katyaBingo">–ë–ò–ù–ì–û üéâ</div>
<button id="katyaReset">–°–±—Ä–æ—Å</button>
</div>
</div>

<script>
const WEBAPP_URL = "–í–°–¢–ê–í–¨ –°–Æ–î–ê –°–°–´–õ–ö–£ –ù–ê APPS SCRIPT";
const lisaTasks = [
"10–∫ —à–∞–≥–æ–≤","–û—Ç–±–æ–π –¥–æ 00:00","30 –º–∏–Ω—É—Ç —Å—Ç–µ–ø–ø–µ—Ä / –∑–∞—Ä—è–¥–∫–∞",
"8/16","30 –º–∏–Ω—É—Ç –ª—é–±–æ–π —É—á—ë–±—ã","30 –º–∏–Ω—É—Ç —É–±–æ—Ä–∫–∏",
"–ù–µ –±–æ–ª–µ–µ 30 –º–∏–Ω—É—Ç –Ω–∞ –∏–Ω—Å—Ç—É –∏ 60 –º–∏–Ω—É—Ç –Ω–∞ —é—Ç—É–±",
"–ü–æ–ª–Ω—ã–π –≤–µ—á–µ—Ä–Ω–∏–π —É—Ö–æ–¥ –∑–∞ –ª–∏—Ü–æ–º","–ó–∞–Ω—è—Ç–∏–µ —Å –ö–æ—Ä–∂–∏–∫–æ–º"
];
const katyaTasks = [
"–ü—Ä–æ–≥—É–ª–∫–∞ –Ω–µ –º–µ–Ω–µ–µ 20 –º–∏–Ω—É—Ç –≤ –¥–µ–Ω—å","–ó–∞—Ä—è–¥–∫–∞ –¥–ª—è —à–µ–∏","–°–æ–Ω 8 —á–∞—Å–æ–≤",
"–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞","–£–±–æ—Ä–∫–∞ –æ–¥–Ω–æ–π –∑–æ–Ω—ã","10 –º–∏–Ω—É—Ç —Å–æ–∑–µ—Ä—Ü–∞–Ω–∏—è",
"30 –º–∏–Ω—É—Ç —á—Ç–µ–Ω–∏—è","–í–æ–≤—Ä–µ–º—è –Ω–∞ —Ä–∞–±–æ—Ç—É (–ø–Ω-–ø—Ç) / –æ—Ç—Ö–æ–¥ –∫–æ —Å–Ω—É –¥–æ 00:00 (—Å–±-–≤—Å)",
"–ú–µ–¥–∏—Ç–∞—Ü–∏—è"
];

let state = { lisa: [], katya: [] };

function createBoard(name,tasks){
    const grid = document.getElementById(name+"Grid");
    grid.innerHTML="";
    tasks.forEach((task,index)=>{
        const cell = document.createElement("div");
        cell.classList.add("cell");
        cell.innerText=task;
        if(state[name].includes(index)) cell.classList.add("active");
        cell.onclick=()=>toggleCell(name,index,cell);
        grid.appendChild(cell);
    });
    checkBingo(name);
}

function toggleCell(name,index,cell){
    if(state[name].includes(index)){
        state[name] = state[name].filter(i=>i!==index);
        cell.classList.remove("active");
    } else {
        state[name].push(index);
        cell.classList.add("active");
    }
    // –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—É
    fetch(WEBAPP_URL,{
        method:"POST",
        body: JSON.stringify({name:name,state:state[name]})
    });
    checkBingo(name);
}

function fetchState(){
    fetch(https://script.google.com/macros/s/AKfycbxxBYZBHNCffusCz-1CQPu1mxKrk2XqvGBN2EbtBNPeDYloGIWBsJ1bJLtHHm209xMGzg/exec+"?action=get")
    .then(r=>r.json())
    .then(data=>{
        state = data;
        createBoard("lisa", lisaTasks);
        createBoard("katya", katyaTasks);
    });
}

function checkBingo(name){
    const bingoElement = document.getElementById(name+"Bingo");
    const wins=[
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
    ];
    const hasBingo = wins.some(combo=>combo.every(i=>state[name].includes(i)));
    bingoElement.style.display = hasBingo ? "block" : "none";
}

function resetBoard(name){
    state[name]=[];
    createBoard(name,name==="lisa"?lisaTasks:katyaTasks);
    fetch(WEBAPP_URL,{method:"POST", body:JSON.stringify({name:name,state:[]})});
}

// –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞
document.getElementById("lisaReset").onclick=()=>resetBoard("lisa");
document.getElementById("katyaReset").onclick=()=>resetBoard("katya");

// –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
setInterval(fetchState,5000);
fetchState();
</script>

</body>
</html>

